Using device: cpu
类别: ['Covid', 'Normal', 'Viral Pneumonia']

========== 阶段一：训练自编码器 ==========
AE Epoch 1/50: 100%|██████████| 8/8 [00:06<00:00,  1.20it/s]
AE Epoch 2/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 3/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 4/50: 100%|██████████| 8/8 [00:06<00:00,  1.20it/s]
AE Epoch 5/50: 100%|██████████| 8/8 [00:07<00:00,  1.11it/s]
AE Epoch [5/50], Loss: 0.0345
AE Epoch 6/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 7/50: 100%|██████████| 8/8 [00:08<00:00,  1.06s/it]
AE Epoch 8/50: 100%|██████████| 8/8 [00:07<00:00,  1.11it/s]
AE Epoch 9/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
AE Epoch 10/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch [10/50], Loss: 0.0188
AE Epoch 11/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
AE Epoch 12/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch 13/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 14/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 15/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
AE Epoch 16/50:   0%|          | 0/8 [00:00<?, ?it/s]AE Epoch [15/50], Loss: 0.0145
AE Epoch 16/50: 100%|██████████| 8/8 [00:06<00:00,  1.19it/s]
AE Epoch 17/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 18/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
AE Epoch 19/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch 20/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 21/50:   0%|          | 0/8 [00:00<?, ?it/s]AE Epoch [20/50], Loss: 0.0123
AE Epoch 21/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
AE Epoch 22/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch 23/50: 100%|██████████| 8/8 [00:07<00:00,  1.14it/s]
AE Epoch 24/50: 100%|██████████| 8/8 [00:08<00:00,  1.09s/it]
AE Epoch 25/50: 100%|██████████| 8/8 [00:07<00:00,  1.00it/s]
AE Epoch [25/50], Loss: 0.0104
AE Epoch 26/50: 100%|██████████| 8/8 [00:07<00:00,  1.03it/s]
AE Epoch 27/50: 100%|██████████| 8/8 [00:07<00:00,  1.10it/s]
AE Epoch 28/50: 100%|██████████| 8/8 [00:07<00:00,  1.09it/s]
AE Epoch 29/50: 100%|██████████| 8/8 [00:07<00:00,  1.11it/s]
AE Epoch 30/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
AE Epoch 31/50:   0%|          | 0/8 [00:00<?, ?it/s]AE Epoch [30/50], Loss: 0.0095
AE Epoch 31/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch 32/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
AE Epoch 33/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
AE Epoch 34/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch 35/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
AE Epoch [35/50], Loss: 0.0090
AE Epoch 36/50: 100%|██████████| 8/8 [00:06<00:00,  1.14it/s]
AE Epoch 37/50: 100%|██████████| 8/8 [00:07<00:00,  1.14it/s]
AE Epoch 38/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch 39/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
AE Epoch 40/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch 41/50:   0%|          | 0/8 [00:00<?, ?it/s]AE Epoch [40/50], Loss: 0.0083
AE Epoch 41/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
AE Epoch 42/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
AE Epoch 43/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch 44/50: 100%|██████████| 8/8 [00:06<00:00,  1.14it/s]
AE Epoch 45/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch [45/50], Loss: 0.0082
AE Epoch 46/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
AE Epoch 47/50: 100%|██████████| 8/8 [00:07<00:00,  1.09it/s]
AE Epoch 48/50: 100%|██████████| 8/8 [00:07<00:00,  1.14it/s]
AE Epoch 49/50: 100%|██████████| 8/8 [00:06<00:00,  1.14it/s]
AE Epoch 50/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
AE Epoch [50/50], Loss: 0.0075

========== 阶段二：训练 CNN ==========
CNN Epoch 1/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 2/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 3/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 4/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 5/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 6/50:   0%|          | 0/8 [00:00<?, ?it/s]CNN Epoch [5/50], Loss: 0.3490, Acc: 88.45%, Grad: 2.5416
CNN Epoch 6/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 7/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 8/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 9/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 10/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 11/50:   0%|          | 0/8 [00:00<?, ?it/s]CNN Epoch [10/50], Loss: 0.3001, Acc: 87.25%, Grad: 2.3396
CNN Epoch 11/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 12/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 13/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 14/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 15/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 16/50:   0%|          | 0/8 [00:00<?, ?it/s]CNN Epoch [15/50], Loss: 0.2630, Acc: 89.64%, Grad: 2.2223
CNN Epoch 16/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 17/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 18/50: 100%|██████████| 8/8 [00:07<00:00,  1.14it/s]
CNN Epoch 19/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 20/50: 100%|██████████| 8/8 [00:07<00:00,  1.13it/s]
CNN Epoch 21/50:   0%|          | 0/8 [00:00<?, ?it/s]CNN Epoch [20/50], Loss: 0.2391, Acc: 91.24%, Grad: 2.9833
CNN Epoch 21/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 22/50: 100%|██████████| 8/8 [00:06<00:00,  1.14it/s]
CNN Epoch 23/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 24/50: 100%|██████████| 8/8 [00:06<00:00,  1.14it/s]
CNN Epoch 25/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch [25/50], Loss: 0.2548, Acc: 89.24%, Grad: 2.4347
CNN Epoch 26/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 27/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 28/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 29/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 30/50: 100%|██████████| 8/8 [00:07<00:00,  1.09it/s]
CNN Epoch [30/50], Loss: 0.2265, Acc: 92.83%, Grad: 2.9228
CNN Epoch 31/50: 100%|██████████| 8/8 [00:07<00:00,  1.14it/s]
CNN Epoch 32/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 33/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 34/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 35/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch [35/50], Loss: 0.1754, Acc: 94.42%, Grad: 2.9677
CNN Epoch 36/50: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
CNN Epoch 37/50: 100%|██████████| 8/8 [00:07<00:00,  1.14it/s]
CNN Epoch 38/50: 100%|██████████| 8/8 [00:06<00:00,  1.14it/s]
CNN Epoch 39/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 40/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 41/50:   0%|          | 0/8 [00:00<?, ?it/s]CNN Epoch [40/50], Loss: 0.1799, Acc: 92.43%, Grad: 2.5602
CNN Epoch 41/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 42/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 43/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch 44/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
CNN Epoch 45/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
CNN Epoch 46/50:   0%|          | 0/8 [00:00<?, ?it/s]CNN Epoch [45/50], Loss: 0.1355, Acc: 94.02%, Grad: 1.7941
CNN Epoch 46/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 47/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 48/50: 100%|██████████| 8/8 [00:06<00:00,  1.18it/s]
CNN Epoch 49/50: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
CNN Epoch 50/50: 100%|██████████| 8/8 [00:06<00:00,  1.16it/s]
CNN Epoch [50/50], Loss: 0.1147, Acc: 96.41%, Grad: 1.7583

========== 最终测试与详细指标 ==========

分类报告 (Classification Report):
                 precision    recall  f1-score   support

          Covid       0.89      0.92      0.91        26
         Normal       0.88      0.75      0.81        20
Viral Pneumonia       0.73      0.80      0.76        20

       accuracy                           0.83        66
      macro avg       0.83      0.82      0.83        66
   weighted avg       0.84      0.83      0.83        66

自编码器模型已保存至: results\autoencoder.pth
CNN 模型已保存至: results\cnn.pth
所有结果图片已保存至 D:\Pycharm\works\MachineLearningEXP\exp6\results 文件夹